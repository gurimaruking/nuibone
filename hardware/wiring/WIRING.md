# NuiBone 配線図

## 回路構成

```
                    ┌─────────────────────────────────────────┐
                    │         単3乾電池 × 3本                  │
                    │            (4.5V)                       │
                    └────────────┬───────────────────────────┘
                                 │
                    ┌────────────┴───────────────┐
                    │                            │
                    ▼                            ▼
              ┌──────────┐               ┌──────────────┐
              │   VIN    │               │  サーボ電源   │
              │          │               │    (4.5V)    │
              │ ESP32-C3 │               └──────┬───────┘
              │          │                      │
              │   GND ───┼──────────────────────┤
              │          │                      │
              │  GPIO13 ─┼───────────┬──────────┼──→ 左腕サーボ (信号)
              │          │           │          │
              │  GPIO12 ─┼───────────┼──────────┼──→ 右腕サーボ (信号)
              │          │           │          │
              │  GPIO14 ─┼───────────┼──────────┼──→ 呼吸サーボ (信号)
              │          │           │          │
              └──────────┘           │          │
                                     ▼          ▼
                              ┌─────────────────────┐
                              │   SG90 × 3          │
                              │  茶: GND            │
                              │  赤: VCC (4.5V)     │
                              │  橙: 信号           │
                              └─────────────────────┘
```

## 詳細配線表

### ESP32-C3-DevKitM-1 ピンアウト

| ESP32ピン | 接続先 | 説明 |
|-----------|--------|------|
| VIN (5V) | 電池+ (4.5V) | 電源入力 |
| GND | 電池-, サーボGND | グランド共通 |
| GPIO13 | 左腕サーボ信号（橙） | PWM出力 |
| GPIO12 | 右腕サーボ信号（橙） | PWM出力 |
| GPIO14 | 呼吸サーボ信号（橙） | PWM出力 |

### SG90サーボ配線

| ワイヤー色 | 接続先 |
|------------|--------|
| 茶色 | GND |
| 赤色 | VCC (4.5V) |
| 橙色 | ESP32 GPIOピン |

## 電源配線の注意点

1. **電池の向き**: 3本直列で4.5V出力になるよう接続
2. **GND共通**: ESP32とサーボのGNDは必ず共通にする
3. **電源スイッチ**: 電池ホルダーのプラス側にスイッチを入れると便利

## 配線図（簡易版）

```
電池(+) ──────┬──→ ESP32 VIN
              │
              └──→ サーボ赤線（3本共通）

電池(-) ──────┬──→ ESP32 GND
              │
              └──→ サーボ茶線（3本共通）

ESP32 GPIO13 ───→ 左腕サーボ橙線
ESP32 GPIO12 ───→ 右腕サーボ橙線
ESP32 GPIO14 ───→ 呼吸サーボ橙線
```

## ブレッドボードを使わない場合

コンパクトにするため、直接はんだ付けを推奨します。

### 推奨ワイヤー

- 電源線: AWG24〜26（赤/黒）
- 信号線: AWG28〜30（橙など）

### はんだ付け手順

1. サーボのGND線（茶）を3本束ねてはんだ付け
2. サーボのVCC線（赤）を3本束ねてはんだ付け
3. 各サーボの信号線を対応するGPIOへ接続
4. 電池ホルダーからの電源線を接続

## トラブルシューティング

| 症状 | 考えられる原因 | 対処法 |
|------|---------------|--------|
| ESP32が起動しない | 電圧不足 | 新しい電池に交換 |
| サーボが動かない | 信号線の接続不良 | はんだ付けを確認 |
| サーボがガクガクする | 電源不足 | 電池を確認、必要なら電池を4本に |
| BLEが接続できない | ファームウェア | シリアルモニタで確認 |
